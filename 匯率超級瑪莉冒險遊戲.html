<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åŒ¯ç‡è¶…ç´šç‘ªè‰å†’éšªéŠæˆ²</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .game-container {
            width: 100%;
            max-width: 1000px;
            padding: 20px;
        }
        
        .game-title {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }
        
        .game-title h1 {
            font-size: 3rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }
        
        .game-screen {
            background: rgba(255,255,255,0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
        }
        
        .market-data {
            background: #e3f2fd;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .market-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        
        .market-item {
            background: white;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
        }
        
        .game-canvas {
            width: 100%;
            height: 400px;
            background: linear-gradient(to bottom, #87CEEB 0%, #98FB98 100%);
            border-radius: 15px;
            position: relative;
            overflow: hidden;
            border: 3px solid #4CAF50;
            margin: 20px 0;
        }
        
        .player {
            position: absolute;
            width: 40px;
            height: 40px;
            font-size: 30px;
            transition: left 0.1s ease;
            z-index: 10;
        }
        
        .platform {
            position: absolute;
            background: #8B4513;
            border-radius: 5px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }
        
        .news-item {
            position: absolute;
            padding: 8px;
            border-radius: 8px;
            font-size: 11px;
            max-width: 120px;
            text-align: center;
            border: 2px solid;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .news-item:hover {
            transform: scale(1.1);
        }
        
        .news-bullish {
            background: #c8e6c9;
            border-color: #4caf50;
            color: #2e7d32;
        }
        
        .news-bearish {
            background: #ffcdd2;
            border-color: #f44336;
            color: #c62828;
        }
        
        .news-mixed {
            background: #fff3e0;
            border-color: #ff9800;
            color: #e65100;
        }
        
        .stats-bar {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 15px;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .stat-item {
            background: #f5f5f5;
            padding: 15px;
            border-radius: 10px;
        }
        
        .stat-value {
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .btn {
            background: linear-gradient(45deg, #4CAF50, #45a049);
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 25px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            margin: 10px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.3);
        }
        
        .btn-secondary {
            background: linear-gradient(45deg, #2196F3, #1976D2);
        }
        
        .advice-panel {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
            max-height: 150px;
            overflow-y: auto;
        }
        
        .advice-item {
            background: white;
            padding: 10px;
            border-radius: 8px;
            margin-bottom: 8px;
            border-left: 4px solid #2196f3;
            font-size: 12px;
        }
        
        .controls {
            position: absolute;
            bottom: 10px;
            left: 10px;
            background: rgba(0,0,0,0.7);
            color: white;
            padding: 8px;
            border-radius: 8px;
            font-size: 11px;
        }
        
        .hidden { display: none; }
        
        @media (max-width: 768px) {
            .game-title h1 { font-size: 2rem; }
            .stats-bar { grid-template-columns: repeat(3, 1fr); }
            .market-grid { grid-template-columns: repeat(2, 1fr); }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <div class="game-title">
            <h1>ğŸ„ åŒ¯ç‡è¶…ç´šç‘ªè‰å†’éšª ğŸ„</h1>
            <p>æ¥ä½è²¡é‡‘æ–°èï¼Œå­¸ç¿’æŠ•è³‡æ™‚æ©Ÿï¼</p>
        </div>
        
        <div class="game-screen">
            <!-- ä¸»é¸å–® -->
            <div id="menu-screen">
                <div style="text-align: center;">
                    <div style="font-size: 4rem; margin-bottom: 20px;">ğŸ®</div>
                    <h2 style="margin-bottom: 20px;">æº–å‚™é–‹å§‹å†’éšªï¼</h2>
                    
                    <div class="market-data">
                        <h3 style="color: #1976d2; margin-bottom: 15px;">ğŸ“ˆ ä»Šæ—¥å¸‚å ´æ•¸æ“š</h3>
                        <div class="market-grid">
                            <div class="market-item">
                                <div style="font-weight: bold; color: #4caf50;">AUD/USD</div>
                                <div style="font-size: 1.2rem; color: #4caf50;">0.6470</div>
                            </div>
                            <div class="market-item">
                                <div style="font-weight: bold;">24Hè®ŠåŒ–</div>
                                <div style="font-size: 1.2rem; color: #4caf50;">+0.65%</div>
                            </div>
                            <div class="market-item">
                                <div style="font-weight: bold;">é˜»åŠ›ä½</div>
                                <div style="font-size: 1.2rem;">0.6625</div>
                            </div>
                            <div class="market-item">
                                <div style="font-weight: bold;">æ”¯æ’ä½</div>
                                <div style="font-size: 1.2rem;">0.6400</div>
                            </div>
                        </div>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin: 20px 0;">
                        <div style="background: #c8e6c9; padding: 20px; border-radius: 10px;">
                            <h3 style="color: #2e7d32; margin-bottom: 15px;">ğŸ¯ éŠæˆ²ç›®æ¨™</h3>
                            <ul style="text-align: left; color: #2e7d32; font-size: 14px;">
                                <li>æ¥ä½æœ‰åˆ©æ–°èå¢åŠ åˆ†æ•¸</li>
                                <li>é¿é–‹è² é¢æ–°èä¿è­·ç”Ÿå‘½</li>
                                <li>æ”¶é›†æŠ•è³‡å»ºè­°å’Œç­–ç•¥</li>
                                <li>æ”¶é›†è˜‘è‡ç²å¾—é¡å¤–çå‹µ</li>
                            </ul>
                        </div>
                        
                        <div style="background: #e3f2fd; padding: 20px; border-radius: 10px;">
                            <h3 style="color: #1976d2; margin-bottom: 15px;">ğŸ® æ“ä½œæ–¹å¼</h3>
                            <ul style="text-align: left; color: #1976d2; font-size: 14px;">
                                <li>â† â†’ æˆ– A/D éµç§»å‹•</li>
                                <li>â†‘ æˆ– ç©ºç™½éµè·³èº</li>
                                <li>é»æ“Šæ–°èä¹Ÿå¯æ”¶é›†</li>
                                <li>ç¶ è‰²ï¼šåˆ©å¤š ç´…è‰²ï¼šåˆ©ç©º</li>
                            </ul>
                        </div>
                    </div>
                    
                    <button class="btn" onclick="startGame()">ğŸš€ é–‹å§‹éŠæˆ²</button>
                </div>
            </div>
            
            <!-- éŠæˆ²ç•«é¢ -->
            <div id="game-screen" class="hidden">
                <div class="stats-bar">
                    <div class="stat-item">
                        <div class="stat-value" style="color: #2196f3;" id="score">0</div>
                        <div>åˆ†æ•¸</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" style="color: #f44336;" id="lives">3</div>
                        <div>ç”Ÿå‘½</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" style="color: #ff9800;" id="coins">0</div>
                        <div>è˜‘è‡</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" style="color: #9c27b0;" id="time">60</div>
                        <div>æ™‚é–“</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" style="color: #4caf50;" id="level">1</div>
                        <div>é—œå¡</div>
                    </div>
                </div>
                
                <div class="game-canvas" id="gameCanvas">
                    <!-- å¹³å° -->
                    <div class="platform" style="left: 0px; top: 370px; width: 200px; height: 20px;"></div>
                    <div class="platform" style="left: 250px; top: 300px; width: 150px; height: 20px;"></div>
                    <div class="platform" style="left: 450px; top: 220px; width: 120px; height: 20px;"></div>
                    <div class="platform" style="left: 600px; top: 350px; width: 100px; height: 20px;"></div>
                    <div class="platform" style="left: 750px; top: 280px; width: 120px; height: 20px;"></div>
                    
                    <!-- ç©å®¶ -->
                    <div class="player" id="player" style="left: 50px; top: 330px;">ğŸ„</div>
                    
                    <!-- æ§åˆ¶èªªæ˜ -->
                    <div class="controls">
                        â† â†’ ç§»å‹• | ç©ºç™½éµè·³èº | é»æ“Šæ–°èæ”¶é›†
                    </div>
                </div>
                
                <div class="advice-panel hidden" id="advicePanel">
                    <h3 style="margin-bottom: 15px;">ğŸ’¡ å³æ™‚æŠ•è³‡å»ºè­°</h3>
                    <div id="adviceList"></div>
                </div>
                
                <div style="text-align: center; margin-top: 20px;">
                    <button class="btn btn-secondary" onclick="pauseGame()">â¸ï¸ æš«åœ</button>
                    <button class="btn" style="background: linear-gradient(45deg, #f44336, #d32f2f);" onclick="endGame()">ğŸ›‘ çµæŸéŠæˆ²</button>
                </div>
            </div>
            
            <!-- éŠæˆ²çµæŸç•«é¢ -->
            <div id="gameover-screen" class="hidden" style="text-align: center;">
                <div style="font-size: 4rem; margin-bottom: 20px;">ğŸ†</div>
                <h2 style="margin-bottom: 20px;">éŠæˆ²çµæŸï¼</h2>
                
                <div class="stats-bar">
                    <div class="stat-item">
                        <div class="stat-value" style="color: #2196f3;" id="finalScore">0</div>
                        <div>æœ€çµ‚åˆ†æ•¸</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" style="color: #ff9800;" id="finalCoins">0</div>
                        <div>æ”¶é›†è˜‘è‡</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" style="color: #4caf50;" id="finalAdvice">0</div>
                        <div>æŠ•è³‡å»ºè­°</div>
                    </div>
                </div>
                
                <div style="background: linear-gradient(45deg, #e3f2fd, #c8e6c9); padding: 30px; border-radius: 15px; margin: 20px 0;">
                    <h3 style="margin-bottom: 20px;">ğŸ“Š æŠ•è³‡ç­–ç•¥ç¸½çµ</h3>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px;">
                        <div>
                            <h4 style="color: #4caf50; margin-bottom: 10px;">âœ… é€²å ´ä¿¡è™Ÿ</h4>
                            <ul style="text-align: left; font-size: 13px; line-height: 1.5;">
                                <li>çªç ´0.6500é˜»åŠ›ä½</li>
                                <li>æ¾³æ´²å¤®è¡Œé·¹æ´¾æ”¿ç­–</li>
                                <li>ä¸­åœ‹ç¶“æ¿Ÿæ•¸æ“šæ”¹å–„</li>
                                <li>éµç¤¦çŸ³åƒ¹æ ¼å›å‡</li>
                            </ul>
                        </div>
                        <div>
                            <h4 style="color: #f44336; margin-bottom: 10px;">âŒ é€€å ´ä¿¡è™Ÿ</h4>
                            <ul style="text-align: left; font-size: 13px; line-height: 1.5;">
                                <li>è·Œç ´0.6400æ”¯æ’ä½</li>
                                <li>ç¾è¯å„²é‡å•Ÿå‡æ¯</li>
                                <li>è²¿æ˜“æˆ°æƒ¡åŒ–</li>
                                <li>æ¾³æ´²æ•¸æ“šè½‰å¼±</li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <div>
                    <button class="btn" onclick="startGame()">ğŸ”„ å†ç©ä¸€æ¬¡</button>
                    <button class="btn btn-secondary" onclick="showMenu()">ğŸ  ä¸»é¸å–®</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // éŠæˆ²ç‹€æ…‹
        let gameState = {
            playing: false,
            score: 0,
            lives: 3,
            coins: 0,
            time: 60,
            level: 1,
            player: { x: 50, y: 330, velocity: 0, onGround: true },
            fallingNews: [],
            advice: []
        };

        // æ–°èæ•¸æ“š
        const newsItems = [
            { text: "AUD/USDæ¼²è‡³0.6470", type: "bullish", points: 20, advice: "æŠ€è¡“é¢çªç ´ï¼Œè€ƒæ…®é€²å ´åšå¤š" },
            { text: "æ¾³æ´²å¤®è¡Œé·¹æ´¾ç«‹å ´", type: "bullish", points: 25, advice: "å‡æ¯é æœŸæ¨å‡æ¾³å…ƒï¼ŒæŒçºŒçœ‹å¤š" },
            { text: "ç¾è¯å„²æš«åœå‡æ¯", type: "bullish", points: 30, advice: "ç¾å…ƒç–²è»Ÿï¼ŒAUDç›¸å°å—ç›Š" },
            { text: "ä¸­åœ‹ç¶“æ¿Ÿæ•¸æ“šç–²è»Ÿ", type: "bearish", points: -15, advice: "æ¾³æ´²å‡ºå£å—å½±éŸ¿ï¼Œè¬¹æ…æ“ä½œ" },
            { text: "éµç¤¦çŸ³åƒ¹æ ¼ä¸‹è·Œ", type: "bearish", points: -20, advice: "æ¾³å…ƒæ‰¿å£“ï¼Œè€ƒæ…®ç²åˆ©äº†çµ" },
            { text: "é€šè†¨æ•¸æ“šè¶…é æœŸ", type: "mixed", points: 10, advice: "çŸ­æœŸæ³¢å‹•åŠ åŠ‡ï¼Œè¨­ç½®åœæ" },
            { text: "å°±æ¥­æ•¸æ“šå¼·å‹", type: "bullish", points: 25, advice: "ç¶“æ¿ŸåŸºæœ¬é¢æ”¹å–„ï¼ŒæŒçºŒæŒæœ‰" },
            { text: "è²¿æ˜“æˆ°å‡æº«", type: "bearish", points: -25, advice: "é¿éšªæƒ…ç·’å‡æº«ï¼Œæ¸›å°‘é¢¨éšªéƒ¨ä½" }
        ];

        // å¹³å°æ•¸æ“š
        const platforms = [
            { x: 0, y: 370, width: 200, height: 20 },
            { x: 250, y: 300, width: 150, height: 20 },
            { x: 450, y: 220, width: 120, height: 20 },
            { x: 600, y: 350, width: 100, height: 20 },
            { x: 750, y: 280, width: 120, height: 20 }
        ];

        let gameLoop;
        let timeInterval;
        let newsInterval;

        // é–‹å§‹éŠæˆ²
        function startGame() {
            gameState = {
                playing: true,
                score: 0,
                lives: 3,
                coins: 0,
                time: 60,
                level: 1,
                player: { x: 50, y: 330, velocity: 0, onGround: true },
                fallingNews: [],
                advice: []
            };

            showScreen('game');
            updateStats();
            
            // æ¸…é™¤ä¹‹å‰çš„æ–°è
            document.querySelectorAll('.news-item').forEach(el => el.remove());
            
            // é–‹å§‹éŠæˆ²å¾ªç’°
            gameLoop = setInterval(updateGame, 50);
            
            // ç”Ÿæˆæ–°è
            newsInterval = setInterval(generateNews, 3000);
            
            // è¨ˆæ™‚å™¨
            timeInterval = setInterval(() => {
                gameState.time -= 0.1;
                updateStats();
                
                if (gameState.time <= 0 || gameState.lives <= 0) {
                    endGame();
                }
            }, 100);
        }

        // æ›´æ–°éŠæˆ²
        function updateGame() {
            if (!gameState.playing) return;
            
            updatePlayer();
            updateFallingNews();
            checkCollisions();
        }

        // æ›´æ–°ç©å®¶
        function updatePlayer() {
            const player = gameState.player;
            
            // æ‡‰ç”¨é‡åŠ›
            if (!player.onGround) {
                player.velocity += 0.8;
            }
            
            player.y += player.velocity;
            player.onGround = false;

            // æª¢æŸ¥å¹³å°ç¢°æ’
            platforms.forEach(platform => {
                if (player.x + 30 > platform.x && 
                    player.x < platform.x + platform.width &&
                    player.y + 30 >= platform.y && 
                    player.y + 30 <= platform.y + 20 &&
                    player.velocity >= 0) {
                    player.y = platform.y - 30;
                    player.velocity = 0;
                    player.onGround = true;
                }
            });

            // åœ°é¢é‚Šç•Œ
            if (player.y > 350) {
                player.y = 350;
                player.velocity = 0;
                player.onGround = true;
            }

            // å´é‚Šé‚Šç•Œ
            if (player.x < 0) player.x = 0;
            if (player.x > 860) player.x = 860;

            // æ›´æ–°DOMä½ç½®
            const playerElement = document.getElementById('player');
            playerElement.style.left = player.x + 'px';
            playerElement.style.top = player.y + 'px';
        }

        // ç”Ÿæˆæ–°è
        function generateNews() {
            if (!gameState.playing) return;
            
            const newsItem = newsItems[Math.floor(Math.random() * newsItems.length)];
            const news = {
                ...newsItem,
                id: Date.now(),
                x: Math.random() * 700,
                y: -50
            };
            
            gameState.fallingNews.push(news);
            
            // å‰µå»ºæ–°èå…ƒç´ 
            const newsElement = document.createElement('div');
            newsElement.id = 'news-' + news.id;
            newsElement.className = 'news-item news-' + news.type;
            newsElement.style.left = news.x + 'px';
            newsElement.style.top = news.y + 'px';
            newsElement.innerHTML = `
                <div style="font-weight: bold; margin-bottom: 2px;">
                    ${news.type === 'bullish' ? 'ğŸ“ˆ' : news.type === 'bearish' ? 'ğŸ“‰' : 'ğŸ“Š'}
                </div>
                <div style="font-weight: bold; font-size: 9px;">${news.text}</div>
                <div style="font-weight: bold; margin-top: 2px;">
                    ${news.points > 0 ? '+' : ''}${news.points}
                </div>
            `;
            
            newsElement.onclick = () => collectNews(news.id);
            document.getElementById('gameCanvas').appendChild(newsElement);
        }

        // æ›´æ–°æ‰è½æ–°è
        function updateFallingNews() {
            gameState.fallingNews = gameState.fallingNews.filter(news => {
                news.y += 2;
                
                const newsElement = document.getElementById('news-' + news.id);
                if (newsElement) {
                    newsElement.style.top = news.y + 'px';
                }
                
                // ç§»é™¤æ‰å‡ºç•«é¢çš„æ–°è
                if (news.y > 420) {
                    if (newsElement) newsElement.remove();
                    return false;
                }
                return true;
            });
        }

        // é¡¯ç¤ºè˜‘è‡çå‹µæ•ˆæœ
        function showMushroom(x, y) {
            const mushroom = document.createElement('div');
            mushroom.innerHTML = 'ğŸ„';
            mushroom.style.position = 'absolute';
            mushroom.style.left = x + 'px';
            mushroom.style.top = y + 'px';
            mushroom.style.fontSize = '20px';
            mushroom.style.zIndex = '15';
            mushroom.style.animation = 'mushroomFloat 1s ease-out forwards';
            
            // æ·»åŠ CSSå‹•ç•«
            if (!document.querySelector('#mushroomStyle')) {
                const style = document.createElement('style');
                style.id = 'mushroomStyle';
                style.textContent = `
                    @keyframes mushroomFloat {
                        0% { transform: translateY(0) scale(1); opacity: 1; }
                        50% { transform: translateY(-30px) scale(1.3); opacity: 0.8; }
                        100% { transform: translateY(-60px) scale(0.5); opacity: 0; }
                    }
                `;
                document.head.appendChild(style);
            }
            
            document.getElementById('gameCanvas').appendChild(mushroom);
            
            setTimeout(() => {
                if (mushroom.parentNode) {
                    mushroom.remove();
                }
            }, 1000);
        }

        // æª¢æŸ¥ç¢°æ’
        function checkCollisions() {
            const player = gameState.player;
            
            gameState.fallingNews.forEach(news => {
                if (Math.abs(player.x + 15 - (news.x + 60)) < 50 && 
                    Math.abs(player.y + 15 - (news.y + 15)) < 35) {
                    collectNews(news.id);
                }
            });
        }

        // æ”¶é›†æ–°è
        function collectNews(newsId) {
            const news = gameState.fallingNews.find(n => n.id === newsId);
            if (!news) return;
            
            // ç§»é™¤æ–°èå…ƒç´ 
            const newsElement = document.getElementById('news-' + newsId);
            if (newsElement) {
                newsElement.style.transform = 'scale(1.5)';
                newsElement.style.opacity = '0';
                setTimeout(() => newsElement.remove(), 200);
            }
            
            // ç§»é™¤å¾æ•¸çµ„
            gameState.fallingNews = gameState.fallingNews.filter(n => n.id !== newsId);
            
            // æ›´æ–°åˆ†æ•¸
            if (news.points > 0) {
                gameState.score += news.points;
                gameState.coins += 1;
                
                // ç”Ÿæˆè˜‘è‡çå‹µæ•ˆæœ
                showMushroom(news.x, news.y);
            } else {
                gameState.lives = Math.max(0, gameState.lives - 1);
            }
            
            // æ·»åŠ å»ºè­°
            gameState.advice.push({
                text: news.advice,
                type: news.type,
                time: new Date().toLocaleTimeString()
            });
            
            updateStats();
            updateAdvice();
        }

        // æ›´æ–°çµ±è¨ˆ
        function updateStats() {
            document.getElementById('score').textContent = gameState.score;
            document.getElementById('lives').textContent = gameState.lives;
            document.getElementById('coins').textContent = gameState.coins;
            document.getElementById('time').textContent = Math.ceil(gameState.time);
            document.getElementById('level').textContent = gameState.level;
        }

        // æ›´æ–°å»ºè­°
        function updateAdvice() {
            const panel = document.getElementById('advicePanel');
            const list = document.getElementById('adviceList');
            
            if (gameState.advice.length > 0) {
                panel.classList.remove('hidden');
                
                list.innerHTML = gameState.advice.slice(-3).reverse().map(advice => `
                    <div class="advice-item">
                        <div style="font-weight: bold; margin-bottom: 3px;">${advice.text}</div>
                        <div style="font-size: 10px; color: #666;">${advice.time}</div>
                    </div>
                `).join('');
            }
        }

        // çµæŸéŠæˆ²
        function endGame() {
            gameState.playing = false;
            clearInterval(gameLoop);
            clearInterval(timeInterval);
            clearInterval(newsInterval);
            
            document.getElementById('finalScore').textContent = gameState.score;
            document.getElementById('finalCoins').textContent = gameState.coins;
            document.getElementById('finalAdvice').textContent = gameState.advice.length;
            
            showScreen('gameover');
        }

        // æš«åœéŠæˆ²
        function pauseGame() {
            if (gameState.playing) {
                gameState.playing = false;
                clearInterval(gameLoop);
                clearInterval(timeInterval);
                clearInterval(newsInterval);
            } else {
                gameState.playing = true;
                gameLoop = setInterval(updateGame, 50);
                timeInterval = setInterval(() => {
                    gameState.time -= 0.1;
                    updateStats();
                    if (gameState.time <= 0 || gameState.lives <= 0) {
                        endGame();
                    }
                }, 100);
                newsInterval = setInterval(generateNews, 3000);
            }
        }

        // é¡¯ç¤ºç•«é¢
        function showScreen(screen) {
            document.getElementById('menu-screen').classList.add('hidden');
            document.getElementById('game-screen').classList.add('hidden');
            document.getElementById('gameover-screen').classList.add('hidden');
            
            if (screen === 'menu') {
                document.getElementById('menu-screen').classList.remove('hidden');
            } else if (screen === 'game') {
                document.getElementById('game-screen').classList.remove('hidden');
            } else if (screen === 'gameover') {
                document.getElementById('gameover-screen').classList.remove('hidden');
            }
        }

        // è¿”å›ä¸»é¸å–®
        function showMenu() {
            gameState.playing = false;
            clearInterval(gameLoop);
            clearInterval(timeInterval);
            clearInterval(newsInterval);
            
            // æ¸…é™¤æ‰€æœ‰æ–°è
            document.querySelectorAll('.news-item').forEach(el => el.remove());
            
            showScreen('menu');
        }

        // éµç›¤æ§åˆ¶
        document.addEventListener('keydown', (e) => {
            if (!gameState.playing) return;
            
            const player = gameState.player;
            
            switch(e.key) {
                case 'ArrowLeft':
                case 'a':
                case 'A':
                    player.x = Math.max(0, player.x - 15);
                    break;
                case 'ArrowRight':
                case 'd':
                case 'D':
                    player.x = Math.min(860, player.x + 15);
                    break;
                case ' ':
                case 'ArrowUp':
                case 'w':
                case 'W':
                    e.preventDefault();
                    if (player.onGround) {
                        player.velocity = -15;
                        player.onGround = false;
                    }
                    break;
            }
        });

        // é˜²æ­¢ç©ºç™½éµæ»¾å‹•é é¢
        document.addEventListener('keydown', (e) => {
            if (e.key === ' ') {
                e.preventDefault();
            }
        });

        // åˆå§‹åŒ–
        window.onload = () => {
            showScreen('menu');
        };
    </script>
</body>
</html>
